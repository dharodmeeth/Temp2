SELECT name, TYPE_NAME(system_type_id) AS DataType
FROM sys.columns
WHERE user_type_id = TYPE_ID('sysname');


-- Step 1: Get publication names from the publication database
USE YourPublicationDatabase;
GO

WITH PublicationDB AS (
    SELECT 
        publication_id,
        LTRIM(RTRIM(publication)) AS PublicationName
    FROM sys.publications
)

-- Step 2: Get publication names from the distribution database
, DistributionDB AS (
    USE distribution;

    SELECT 
        publisher_db,
        LTRIM(RTRIM(publication)) AS PublicationName
    FROM MSpublications
    WHERE publisher_db = 'YourPublicationDatabase'
)

-- Step 3: Compare the two sets
SELECT p.PublicationName AS PublicationDBName,
       d.PublicationName AS DistributionDBName,
       CASE 
           WHEN p.PublicationName = d.PublicationName THEN 'Match'
           ELSE 'Mismatch'
       END AS Status
FROM PublicationDB p
FULL OUTER JOIN DistributionDB d
    ON p.PublicationName = d.PublicationName;
